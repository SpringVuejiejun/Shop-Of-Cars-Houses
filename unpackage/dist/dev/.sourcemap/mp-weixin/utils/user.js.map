{"version":3,"file":"user.js","sources":["utils/user.js"],"sourcesContent":["// 清除本地缓存\r\nuni.clearStorageSync();\r\n\r\n// 用户数据管理工具\r\nconst userData = {\r\n\t// 用户信息\r\n\tuserInfo: {\r\n\t\tbalance: 1680000, // 初始余额168万\r\n\t\tlastSignIn: null, // 上次签到时间\r\n\t\torders: [], // 订单列表\r\n\t\tgameTimes: 10, // 游戏次数\r\n\t\tgameRecords: [], // 游戏记录\r\n\t\tcoupons: [], // 优惠券列表\r\n\t\tavatar: 'https://img.picui.cn/free/2025/05/09/681e03456a7b0.jpg',\r\n\t\tnickname: '福布斯在榜者',\r\n\t\tID: '88888888',\r\n\t\tphone: '',\r\n\t\tfrozenAmount: 3000000, // 冻结金额\r\n\t\taddresses: [] // 地址列表\r\n\t},\r\n\r\n\t// 获取游戏记录\r\n\tgetGameRecords() {\r\n\t\tconst userInfo = this.getUserInfo()\r\n\t\treturn userInfo.gameRecords || []\r\n\t},\r\n\r\n\t// 获得游戏次数\r\n\tgetGameTimes(){\r\n\t\treturn this.userInfo.gameTimes\r\n\t},\r\n\t\r\n\t// 获取用户信息\r\n\tgetUserInfo() {\r\n\t\ttry {\r\n\t\t\tconst userInfo = uni.getStorageSync('userInfo')\r\n\t\t\tif (userInfo) {\r\n\t\t\t\tthis.userInfo = JSON.parse(userInfo)\r\n\t\t\t}\r\n\t\t\treturn this.userInfo\r\n\t\t} catch (e) {\r\n\t\t\tconsole.error('获取用戶信息失败：', e)\r\n\t\t\treturn this.userInfo\r\n\t\t}\r\n\t},\r\n\r\n\tupdateUserInfo(userInfo){\r\n\t\tthis.userInfo = userInfo\r\n\t\tthis.saveUserInfo()\r\n\t},\r\n\t\r\n\t// 保存用户信息\r\n\tsaveUserInfo() {\r\n\t\ttry {\r\n\t\t\tuni.setStorageSync('userInfo', JSON.stringify(this.userInfo))\r\n\t\t} catch (e) {\r\n\t\t\tconsole.error('保存用戶信息失败：', e)\r\n\t\t}\r\n\t},\r\n\t\r\n\t// 签到\r\n\tsignIn() {\r\n\t\tconst today = new Date().toDateString()\r\n\t\tif (this.userInfo.lastSignIn === today) {\r\n\t\t\treturn {\r\n\t\t\t\tsuccess: false,\r\n\t\t\t\tmessage: '今天已经签到过了'\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tthis.userInfo.balance += 50000 // 签到奖励5万\r\n\t\tthis.userInfo.lastSignIn = today\r\n\t\tthis.saveUserInfo()\r\n\t\t\r\n\t\treturn {\r\n\t\t\tsuccess: true,\r\n\t\t\tmessage: '签到成功，获得5万奖励'\r\n\t\t}\r\n\t},\r\n\t\r\n\t// 更新余额\r\n\tupdateBalance(amount) {\r\n\t\tthis.userInfo.balance += amount\r\n\t\tthis.saveUserInfo()\r\n\t},\r\n\t\r\n\t// 添加订单\r\n\taddOrder(order) {\r\n\t\t// 生成订单号\r\n\t\tconst orderNo = 'HC' + Date.now().toString().slice(-8)\r\n\t\t// 设置支付截止时间（24小时后）\r\n\t\tconst payDeadline = new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString()\r\n\t\t// 设置预计发货时间（支付后3天）\r\n\t\tconst estimatedDelivery = new Date(Date.now() + 3 * 24 * 60 * 60 * 1000).toISOString()\r\n\t\t\r\n\t\tconst newOrder = {\r\n\t\t\tid: orderNo,\r\n\t\t\tproductId: order.productId,\r\n\t\t\tproductName: order.productName,\r\n\t\t\tproductImage: order.productImage,\r\n\t\t\tsku: order.sku,\r\n\t\t\tprice: order.price,\r\n\t\t\tstatus: '待付款',\r\n\t\t\tcreateTime: new Date().toISOString(),\r\n\t\t\tpayDeadline: payDeadline,\r\n\t\t\testimatedDelivery: estimatedDelivery\r\n\t\t}\r\n\t\t\r\n\t\tthis.userInfo.orders.unshift(newOrder)\r\n\t\tthis.saveUserInfo()\r\n\t\treturn newOrder\r\n\t},\r\n\t\r\n\t// 获取订单列表\r\n\tgetOrderList() {\r\n\t\treturn this.userInfo.orders\r\n\t},\r\n\t\r\n\t// 获取指定状态的订单列表\r\n\tgetOrdersByStatus(status) {\r\n\t\tif (status === 'all') {\r\n\t\t\treturn this.userInfo.orders\r\n\t\t}\r\n\t\treturn this.userInfo.orders.filter(order => order.status === status)\r\n\t},\r\n\t\r\n\t// 获取订单详情\r\n\tgetOrderById(orderId) {\r\n\t\treturn this.userInfo.orders.find(order => order.id === orderId)\r\n\t},\r\n\t\r\n\t// 更新订单\r\n\tupdateOrder(updatedOrder) {\r\n\t\tconst index = this.userInfo.orders.findIndex(order => order.id === updatedOrder.id)\r\n\t\tif (index !== -1) {\r\n\t\t\tthis.userInfo.orders[index] = updatedOrder\r\n\t\t\tthis.saveUserInfo()\r\n\t\t\treturn true\r\n\t\t}\r\n\t\treturn false\r\n\t},\r\n\t\r\n\t// 删除订单\r\n\tdeleteOrder(orderId) {\r\n\t\tconst index = this.userInfo.orders.findIndex(order => order.id === orderId)\r\n\t\tif (index !== -1) {\r\n\t\t\tthis.userInfo.orders.splice(index, 1)\r\n\t\t\tthis.saveUserInfo()\r\n\t\t\treturn true\r\n\t\t}\r\n\t\treturn false\r\n\t},\r\n\t\r\n\t// 取消订单\r\n\tcancelOrder(orderId) {\r\n\t\tconst order = this.getOrderById(orderId)\r\n\t\tif (order && order.status === '待付款') {\r\n\t\t\torder.status = '已取消'\r\n\t\t\tthis.updateOrder(order)\r\n\t\t\treturn true\r\n\t\t}\r\n\t\treturn false\r\n\t},\r\n\t\r\n\t// 确认收货\r\n\tconfirmReceive(orderId) {\r\n\t\tconst order = this.getOrderById(orderId)\r\n\t\tif (order && order.status === '待收货') {\r\n\t\t\torder.status = '已完成'\r\n\t\t\tthis.updateOrder(order)\r\n\t\t\treturn true\r\n\t\t}\r\n\t\treturn false\r\n\t},\r\n\t\r\n\t// 获取订单状态统计\r\n\tgetOrderStatusCount() {\r\n\t\tconst counts = {\r\n\t\t\tall: this.userInfo.orders.length,\r\n\t\t\t待付款: 0,\r\n\t\t\t待发货: 0,\r\n\t\t\t待收货: 0,\r\n\t\t\t已完成: 0,\r\n\t\t\t已取消: 0\r\n\t\t}\r\n\t\t\r\n\t\tthis.userInfo.orders.forEach(order => {\r\n\t\t\tcounts[order.status]++\r\n\t\t})\r\n\t\t\r\n\t\treturn counts\r\n\t},\r\n\t\r\n\t// 更新游戏次数\r\n\tupdateGameTimes(times) {\r\n\t\tconst userInfo = this.getUserInfo()\r\n\t\tuserInfo.gameTimes = times\r\n\t\tthis.saveUserInfo()\r\n\t},\r\n\t\r\n\t// 添加游戏记录\r\n\taddGameRecord(record) {\r\n\t\tconst userInfo = this.getUserInfo()\r\n\t\tif (!userInfo.gameRecords) {\r\n\t\t\tuserInfo.gameRecords = []\r\n\t\t}\r\n\t\tuserInfo.gameRecords.unshift(record)\r\n\t\tthis.saveUserInfo()\r\n\t},\r\n\t\r\n\t// 添加优惠券\r\n\taddCoupon(coupon) {\r\n\t\tconst userInfo = this.getUserInfo()\r\n\t\tif (!userInfo.coupons) {\r\n\t\t\tuserInfo.coupons = []\r\n\t\t}\r\n\t\tuserInfo.coupons.push(coupon)\r\n\t\tthis.saveUserInfo()\r\n\t},\r\n\t\r\n\t// 获取可用优惠券\r\n\tgetValidCoupons() {\r\n\t\tconst userInfo = this.getUserInfo()\r\n\t\tif (!userInfo.coupons) return []\r\n\t\tconst now = new Date()\r\n\t\treturn userInfo.coupons.filter(coupon => {\r\n\t\t\treturn new Date(coupon.expireTime) > now\r\n\t\t})\r\n\t},\r\n\t\r\n\t// 使用优惠券\r\n\tuseCoupon(couponId) {\r\n\t\tconst userInfo = this.getUserInfo()\r\n\t\tif (!userInfo.coupons) return false\r\n\t\tconst index = userInfo.coupons.findIndex(coupon => coupon.id === couponId)\r\n\t\tif (index === -1) return false\r\n\t\tuserInfo.coupons.splice(index, 1)\r\n\t\tthis.saveUserInfo()\r\n\t\treturn true\r\n\t},\r\n\r\n\t// 获取地址列表\r\n\tgetAddressList() {\r\n\t\tconst userInfo = this.getUserInfo()\r\n\t\treturn userInfo.addresses || []\r\n\t},\r\n\r\n\t// 添加地址\r\n\taddAddress(address) {\r\n\t\tconst userInfo = this.getUserInfo()\r\n\t\tif (!userInfo.addresses) {\r\n\t\t\tuserInfo.addresses = []\r\n\t\t}\r\n\t\t\r\n\t\t// 如果设置为默认地址，将其他地址的默认状态设为false\r\n\t\tif (address.isDefault) {\r\n\t\t\tuserInfo.addresses.forEach(addr => addr.isDefault = false)\r\n\t\t}\r\n\t\t\r\n\t\tuserInfo.addresses.push(address)\r\n\t\tthis.saveUserInfo()\r\n\t},\r\n\r\n\t// 更新地址\r\n\tupdateAddress(index, address) {\r\n\t\tconst userInfo = this.getUserInfo()\r\n\t\tif (!userInfo.addresses || index >= userInfo.addresses.length) {\r\n\t\t\treturn false\r\n\t\t}\r\n\t\t\r\n\t\t// 如果设置为默认地址，将其他地址的默认状态设为false\r\n\t\tif (address.isDefault) {\r\n\t\t\tuserInfo.addresses.forEach(addr => addr.isDefault = false)\r\n\t\t}\r\n\t\t\r\n\t\tuserInfo.addresses[index] = address\r\n\t\tthis.saveUserInfo()\r\n\t\treturn true\r\n\t},\r\n\r\n\t// 删除地址\r\n\tdeleteAddress(index) {\r\n\t\tconst userInfo = this.getUserInfo()\r\n\t\tif (!userInfo.addresses || index >= userInfo.addresses.length) {\r\n\t\t\treturn false\r\n\t\t}\r\n\t\t\r\n\t\tuserInfo.addresses.splice(index, 1)\r\n\t\tthis.saveUserInfo()\r\n\t\treturn true\r\n\t},\r\n\r\n\t// 设置默认地址\r\n\tsetDefaultAddress(index) {\r\n\t\tconst userInfo = this.getUserInfo()\r\n\t\tif (!userInfo.addresses || index >= userInfo.addresses.length) {\r\n\t\t\treturn false\r\n\t\t}\r\n\t\t\r\n\t\tuserInfo.addresses.forEach((addr, i) => {\r\n\t\t\taddr.isDefault = i === index\r\n\t\t})\r\n\t\t\r\n\t\tthis.saveUserInfo()\r\n\t\treturn true\r\n\t}\r\n}\r\n\r\nexport default userData "],"names":["uni"],"mappings":";;AACAA,cAAG,MAAC,iBAAgB;AAGf,MAAC,WAAW;AAAA;AAAA,EAEhB,UAAU;AAAA,IACT,SAAS;AAAA;AAAA,IACT,YAAY;AAAA;AAAA,IACZ,QAAQ,CAAE;AAAA;AAAA,IACV,WAAW;AAAA;AAAA,IACX,aAAa,CAAE;AAAA;AAAA,IACf,SAAS,CAAE;AAAA;AAAA,IACX,QAAQ;AAAA,IACR,UAAU;AAAA,IACV,IAAI;AAAA,IACJ,OAAO;AAAA,IACP,cAAc;AAAA;AAAA,IACd,WAAW,CAAE;AAAA;AAAA,EACb;AAAA;AAAA,EAGD,iBAAiB;AAChB,UAAM,WAAW,KAAK,YAAa;AACnC,WAAO,SAAS,eAAe,CAAE;AAAA,EACjC;AAAA;AAAA,EAGD,eAAc;AACb,WAAO,KAAK,SAAS;AAAA,EACrB;AAAA;AAAA,EAGD,cAAc;AACb,QAAI;AACH,YAAM,WAAWA,cAAAA,MAAI,eAAe,UAAU;AAC9C,UAAI,UAAU;AACb,aAAK,WAAW,KAAK,MAAM,QAAQ;AAAA,MACnC;AACD,aAAO,KAAK;AAAA,IACZ,SAAQ,GAAG;AACXA,oBAAAA,MAAA,MAAA,SAAA,uBAAc,aAAa,CAAC;AAC5B,aAAO,KAAK;AAAA,IACZ;AAAA,EACD;AAAA,EAED,eAAe,UAAS;AACvB,SAAK,WAAW;AAChB,SAAK,aAAc;AAAA,EACnB;AAAA;AAAA,EAGD,eAAe;AACd,QAAI;AACHA,oBAAG,MAAC,eAAe,YAAY,KAAK,UAAU,KAAK,QAAQ,CAAC;AAAA,IAC5D,SAAQ,GAAG;AACXA,oBAAAA,MAAA,MAAA,SAAA,uBAAc,aAAa,CAAC;AAAA,IAC5B;AAAA,EACD;AAAA;AAAA,EAGD,SAAS;AACR,UAAM,SAAQ,oBAAI,KAAM,GAAC,aAAc;AACvC,QAAI,KAAK,SAAS,eAAe,OAAO;AACvC,aAAO;AAAA,QACN,SAAS;AAAA,QACT,SAAS;AAAA,MACT;AAAA,IACD;AAED,SAAK,SAAS,WAAW;AACzB,SAAK,SAAS,aAAa;AAC3B,SAAK,aAAc;AAEnB,WAAO;AAAA,MACN,SAAS;AAAA,MACT,SAAS;AAAA,IACT;AAAA,EACD;AAAA;AAAA,EAGD,cAAc,QAAQ;AACrB,SAAK,SAAS,WAAW;AACzB,SAAK,aAAc;AAAA,EACnB;AAAA;AAAA,EAGD,SAAS,OAAO;AAEf,UAAM,UAAU,OAAO,KAAK,IAAK,EAAC,SAAU,EAAC,MAAM,EAAE;AAErD,UAAM,cAAc,IAAI,KAAK,KAAK,IAAG,IAAK,KAAK,KAAK,KAAK,GAAI,EAAE,YAAa;AAE5E,UAAM,oBAAoB,IAAI,KAAK,KAAK,IAAK,IAAG,IAAI,KAAK,KAAK,KAAK,GAAI,EAAE,YAAa;AAEtF,UAAM,WAAW;AAAA,MAChB,IAAI;AAAA,MACJ,WAAW,MAAM;AAAA,MACjB,aAAa,MAAM;AAAA,MACnB,cAAc,MAAM;AAAA,MACpB,KAAK,MAAM;AAAA,MACX,OAAO,MAAM;AAAA,MACb,QAAQ;AAAA,MACR,aAAY,oBAAI,KAAM,GAAC,YAAa;AAAA,MACpC;AAAA,MACA;AAAA,IACA;AAED,SAAK,SAAS,OAAO,QAAQ,QAAQ;AACrC,SAAK,aAAc;AACnB,WAAO;AAAA,EACP;AAAA;AAAA,EAGD,eAAe;AACd,WAAO,KAAK,SAAS;AAAA,EACrB;AAAA;AAAA,EAGD,kBAAkB,QAAQ;AACzB,QAAI,WAAW,OAAO;AACrB,aAAO,KAAK,SAAS;AAAA,IACrB;AACD,WAAO,KAAK,SAAS,OAAO,OAAO,WAAS,MAAM,WAAW,MAAM;AAAA,EACnE;AAAA;AAAA,EAGD,aAAa,SAAS;AACrB,WAAO,KAAK,SAAS,OAAO,KAAK,WAAS,MAAM,OAAO,OAAO;AAAA,EAC9D;AAAA;AAAA,EAGD,YAAY,cAAc;AACzB,UAAM,QAAQ,KAAK,SAAS,OAAO,UAAU,WAAS,MAAM,OAAO,aAAa,EAAE;AAClF,QAAI,UAAU,IAAI;AACjB,WAAK,SAAS,OAAO,KAAK,IAAI;AAC9B,WAAK,aAAc;AACnB,aAAO;AAAA,IACP;AACD,WAAO;AAAA,EACP;AAAA;AAAA,EAGD,YAAY,SAAS;AACpB,UAAM,QAAQ,KAAK,SAAS,OAAO,UAAU,WAAS,MAAM,OAAO,OAAO;AAC1E,QAAI,UAAU,IAAI;AACjB,WAAK,SAAS,OAAO,OAAO,OAAO,CAAC;AACpC,WAAK,aAAc;AACnB,aAAO;AAAA,IACP;AACD,WAAO;AAAA,EACP;AAAA;AAAA,EAGD,YAAY,SAAS;AACpB,UAAM,QAAQ,KAAK,aAAa,OAAO;AACvC,QAAI,SAAS,MAAM,WAAW,OAAO;AACpC,YAAM,SAAS;AACf,WAAK,YAAY,KAAK;AACtB,aAAO;AAAA,IACP;AACD,WAAO;AAAA,EACP;AAAA;AAAA,EAGD,eAAe,SAAS;AACvB,UAAM,QAAQ,KAAK,aAAa,OAAO;AACvC,QAAI,SAAS,MAAM,WAAW,OAAO;AACpC,YAAM,SAAS;AACf,WAAK,YAAY,KAAK;AACtB,aAAO;AAAA,IACP;AACD,WAAO;AAAA,EACP;AAAA;AAAA,EAGD,sBAAsB;AACrB,UAAM,SAAS;AAAA,MACd,KAAK,KAAK,SAAS,OAAO;AAAA,MAC1B,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,MACL,KAAK;AAAA,IACL;AAED,SAAK,SAAS,OAAO,QAAQ,WAAS;AACrC,aAAO,MAAM,MAAM;AAAA,IACtB,CAAG;AAED,WAAO;AAAA,EACP;AAAA;AAAA,EAGD,gBAAgB,OAAO;AACtB,UAAM,WAAW,KAAK,YAAa;AACnC,aAAS,YAAY;AACrB,SAAK,aAAc;AAAA,EACnB;AAAA;AAAA,EAGD,cAAc,QAAQ;AACrB,UAAM,WAAW,KAAK,YAAa;AACnC,QAAI,CAAC,SAAS,aAAa;AAC1B,eAAS,cAAc,CAAE;AAAA,IACzB;AACD,aAAS,YAAY,QAAQ,MAAM;AACnC,SAAK,aAAc;AAAA,EACnB;AAAA;AAAA,EAGD,UAAU,QAAQ;AACjB,UAAM,WAAW,KAAK,YAAa;AACnC,QAAI,CAAC,SAAS,SAAS;AACtB,eAAS,UAAU,CAAE;AAAA,IACrB;AACD,aAAS,QAAQ,KAAK,MAAM;AAC5B,SAAK,aAAc;AAAA,EACnB;AAAA;AAAA,EAGD,kBAAkB;AACjB,UAAM,WAAW,KAAK,YAAa;AACnC,QAAI,CAAC,SAAS;AAAS,aAAO,CAAE;AAChC,UAAM,MAAM,oBAAI,KAAM;AACtB,WAAO,SAAS,QAAQ,OAAO,YAAU;AACxC,aAAO,IAAI,KAAK,OAAO,UAAU,IAAI;AAAA,IACxC,CAAG;AAAA,EACD;AAAA;AAAA,EAGD,UAAU,UAAU;AACnB,UAAM,WAAW,KAAK,YAAa;AACnC,QAAI,CAAC,SAAS;AAAS,aAAO;AAC9B,UAAM,QAAQ,SAAS,QAAQ,UAAU,YAAU,OAAO,OAAO,QAAQ;AACzE,QAAI,UAAU;AAAI,aAAO;AACzB,aAAS,QAAQ,OAAO,OAAO,CAAC;AAChC,SAAK,aAAc;AACnB,WAAO;AAAA,EACP;AAAA;AAAA,EAGD,iBAAiB;AAChB,UAAM,WAAW,KAAK,YAAa;AACnC,WAAO,SAAS,aAAa,CAAE;AAAA,EAC/B;AAAA;AAAA,EAGD,WAAW,SAAS;AACnB,UAAM,WAAW,KAAK,YAAa;AACnC,QAAI,CAAC,SAAS,WAAW;AACxB,eAAS,YAAY,CAAE;AAAA,IACvB;AAGD,QAAI,QAAQ,WAAW;AACtB,eAAS,UAAU,QAAQ,UAAQ,KAAK,YAAY,KAAK;AAAA,IACzD;AAED,aAAS,UAAU,KAAK,OAAO;AAC/B,SAAK,aAAc;AAAA,EACnB;AAAA;AAAA,EAGD,cAAc,OAAO,SAAS;AAC7B,UAAM,WAAW,KAAK,YAAa;AACnC,QAAI,CAAC,SAAS,aAAa,SAAS,SAAS,UAAU,QAAQ;AAC9D,aAAO;AAAA,IACP;AAGD,QAAI,QAAQ,WAAW;AACtB,eAAS,UAAU,QAAQ,UAAQ,KAAK,YAAY,KAAK;AAAA,IACzD;AAED,aAAS,UAAU,KAAK,IAAI;AAC5B,SAAK,aAAc;AACnB,WAAO;AAAA,EACP;AAAA;AAAA,EAGD,cAAc,OAAO;AACpB,UAAM,WAAW,KAAK,YAAa;AACnC,QAAI,CAAC,SAAS,aAAa,SAAS,SAAS,UAAU,QAAQ;AAC9D,aAAO;AAAA,IACP;AAED,aAAS,UAAU,OAAO,OAAO,CAAC;AAClC,SAAK,aAAc;AACnB,WAAO;AAAA,EACP;AAAA;AAAA,EAGD,kBAAkB,OAAO;AACxB,UAAM,WAAW,KAAK,YAAa;AACnC,QAAI,CAAC,SAAS,aAAa,SAAS,SAAS,UAAU,QAAQ;AAC9D,aAAO;AAAA,IACP;AAED,aAAS,UAAU,QAAQ,CAAC,MAAM,MAAM;AACvC,WAAK,YAAY,MAAM;AAAA,IAC1B,CAAG;AAED,SAAK,aAAc;AACnB,WAAO;AAAA,EACP;AACF;;"}